<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head'); %>

    <title>Search for logs</title>
  </head>
  <body class="d-flex pt-4">
    <form class="d-flex" method="get">
      <input
        class="form-control me-2"
        aria-label="Search"
        name="q"
        placeholder="e.g., ip.src==192.168.0.1 AND ip.dst==10.0.0.1 AND tcp.port==80"
        type="search"
        value="<%= q %>"
      />
      <button class="btn btn-outline-success" type="submit">Search</button>
    </form>
    <table class="table table-striped table-hover mt-3 mb-0">
      <tr>
        <th>Id</th>
        <th>Source IP</th>
        <th>Destination IP</th>
        <th>Port</th>
        <th>Date</th>
      </tr>
      <% logs.forEach((log) => { %>
      <tr>
        <td><%= log.id %></td>
        <td><%= log.sourceIP %></td>
        <td><%= log.destinationIP %></td>
        <td><%= log.port %></td>
        <td><%= log.date %></td>
      </tr>
      <% }); %>
    </table>

    <footer><%- include('../partials/footer'); %></footer>
  </body>
</html>
